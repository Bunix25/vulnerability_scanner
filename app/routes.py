from flask import Blueprint, request, render_template
from scanner.sql_injection import check_sql_injection
from scanner.xss import check_xss
from scanner.csrf import check_csrf  # Correct the import here
from scanner.command_injection import check_command_injection
from scanner.directory_traversal import check_directory_traversal

bp = Blueprint('routes', __name__)

@bp.route('/')
def index():
    return render_template('index.html')

@bp.route('/scan', methods=['POST'])
def scan():
    url = request.form['url']
    results = {
        'sql_injection': check_sql_injection(url),
        'xss': check_xss(url),
        'csrf': check_csrf(url),
        'command_injection': check_command_injection(url),
        'directory_traversal': check_directory_traversal(url)
    }
    return render_template('results.html', results=results)